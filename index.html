<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Cruise Official</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
:root {
    --primary: #2481cc;
    --bg: #000;
    --panel: #0d0d0d;
    --border: #1a1a1a;
    --studio-bg: #a4a933; /* The olive/yellow color from your screenshot */
}
* { box-sizing: border-box; margin:0; padding:0; -webkit-tap-highlight-color: transparent; }
body, html { width:100%; height:100%; background:var(--bg); font-family:-apple-system, sans-serif; color:#fff; overflow:hidden; }

/* MAIN APP NAVBAR & CONTENT */
.navbar { display:flex; justify-content:space-between; align-items:center; padding:0 20px; height:60px; background:#000; border-bottom:1px solid var(--border); position:fixed; top:0; width:100%; z-index:10; }
.logo { font-weight:900; letter-spacing:5px; font-size:18px; }

/* POST STUDIO (The WhatsApp Style Popup) */
#studio {
    position: fixed; inset: 0; background: var(--studio-bg);
    z-index: 5000; display: none; flex-direction: column;
    transition: background 0.3s ease;
}
#studio.active { display: flex; }

.studio-header { display: flex; justify-content: space-between; padding: 20px; align-items: center; }
.close-circle { width: 40px; height: 40px; background: rgba(0,0,0,0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; border: none; color: #fff; }
.studio-tools { display: flex; gap: 15px; }
.tool-icon { width: 40px; height: 40px; background: rgba(0,0,0,0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; border: none; color: #fff; font-weight: bold; }

.studio-main { flex: 1; display: flex; align-items: center; justify-content: center; padding: 40px; }
#studio-input { width: 100%; background: transparent; border: none; color: #fff; font-size: 32px; text-align: center; resize: none; font-weight: 500; }
#studio-input::placeholder { color: rgba(255,255,255,0.6); }

/* BOTTOM MODE PICKER */
.mode-picker-wrap { background: rgba(0,0,0,0.4); padding: 20px 0 40px; }
.mode-picker { display: flex; justify-content: center; align-items: center; gap: 20px; }
.mode-btn { background: none; border: none; color: #fff; font-size: 14px; font-weight: 600; opacity: 0.6; padding: 8px 15px; border-radius: 20px; transition: 0.2s; }
.mode-btn.active { opacity: 1; background: rgba(255,255,255,0.15); }

/* MAIN NAV */
.bottom-nav { position:fixed; bottom:0; width:100%; height:80px; background:#000; border-top:1px solid var(--border); display:flex; justify-content:space-around; align-items:center; padding-bottom:15px; }
.nav-item { background:none; border:none; color:#444; display:flex; flex-direction:column; align-items:center; gap:4px; font-size:10px; font-weight:bold; }
.add-fab { width:55px; height:55px; background:var(--primary); border-radius:18px; color:#fff; font-size:30px; border:none; transform:translateY(-15px); }

/* FEED */
.feed-area { margin-top: 60px; height: calc(100vh - 140px); overflow-y: auto; padding: 15px; }
.post-card { background: #111; border-radius: 15px; padding: 15px; margin-bottom: 15px; border: 1px solid #222; }
</style>
</head>
<body>

<nav class="navbar"><div class="logo">CRUISE</div><div style="font-size:10px; color:#00ff00;">‚óè LIVE</div></nav>

<div class="feed-area" id="feed"></div>

<div class="bottom-nav">
    <button class="nav-item" onclick="location.reload()"><i>üöÄ</i>Feed</button>
    <button class="add-fab" onclick="openStudio()">+</button>
    <button class="nav-item"><i>üë§</i>Profile</button>
</div>

<div id="studio">
    <div class="studio-header">
        <button class="close-circle" onclick="closeStudio()">‚úï</button>
        <div class="studio-tools">
            <button class="tool-icon" onclick="changeBg()">üé®</button>
            <button class="tool-icon">Aa</button>
        </div>
    </div>

    <div class="studio-main">
        <textarea id="studio-input" placeholder="Type a status" oninput="autoGrow(this)"></textarea>
    </div>

    <div class="mode-picker-wrap">
        <div class="mode-picker">
            <button class="mode-btn" onclick="setMode('Video', this)">Video</button>
            <button class="mode-btn" onclick="setMode('Photo', this)">Photo</button>
            <button class="mode-btn active" onclick="setMode('Text', this)">Text</button>
            <button class="mode-btn" onclick="setMode('Voice', this)">Voice</button>
        </div>
        <div style="text-align: center; margin-top: 20px;">
            <button onclick="publishCruise()" style="background:#fff; color:#000; border:none; padding:12px 40px; border-radius:30px; font-weight:bold;">CRUISE IT</button>
        </div>
    </div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

// Supabase Init
const SB_URL = "https://chsybopznpfdvhmdspox.supabase.co"; 
const SB_KEY = "sb_publishable_IfqycsZxpWeXgSPA5U7D5w_u-nl_FJf";
const sb = supabase.createClient(SB_URL, SB_KEY);

const myName = tg.initDataUnsafe?.user?.first_name || "Cruiser";

function openStudio() { document.getElementById('studio').classList.add('active'); }
function closeStudio() { document.getElementById('studio').classList.remove('active'); }

function setMode(mode, btn) {
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    
    const input = document.getElementById('studio-input');
    if(mode === 'Text') {
        input.style.display = 'block';
        input.placeholder = "Type a status";
    } else {
        input.style.display = 'none';
        tg.showAlert(mode + " mode coming soon!");
    }
}

const colors = ['#a4a933', '#2481cc', '#8e44ad', '#e67e22', '#c0392b'];
let colorIdx = 0;
function changeBg() {
    colorIdx = (colorIdx + 1) % colors.length;
    document.getElementById('studio').style.backgroundColor = colors[colorIdx];
}

function autoGrow(element) {
    element.style.height = "5px";
    element.style.height = (element.scrollHeight) + "px";
}

async function publishCruise() {
    const val = document.getElementById('studio-input').value;
    if(!val.trim()) return tg.showAlert("Type something first!");

    const { error } = await sb.from('posts').insert([{ 
        username: myName, 
        content: val 
    }]);

    if(!error) {
        document.getElementById('studio-input').value = "";
        closeStudio();
        loadFeed();
        tg.HapticFeedback.notificationOccurred('success');
    }
}

async function loadFeed() {
    const { data } = await sb.from('posts').select('*').order('created_at', { ascending: false });
    if(data) {
        document.getElementById('feed').innerHTML = data.map(p => `
            <div class="post-card">
                <div style="color:var(--primary); font-weight:bold; font-size:12px; margin-bottom:8px;">@${p.username}</div>
                <div style="font-size:16px;">${p.content}</div>
            </div>
        `).join('');
    }
}

loadFeed();
</script>
</body>
</html>
