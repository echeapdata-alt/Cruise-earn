<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cruise App</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
body, html {
    margin:0; padding:0; width:100%; height:100%; font-family:-apple-system,sans-serif; overflow:hidden;
}

/* SPLASH SCREEN */
#splash {
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:#000;
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:5000;
    flex-direction:column;
    transition: opacity 0.5s ease;
}

#splash img {
    width:150px;
    height:150px;
    object-fit:contain;
    margin-bottom:20px;
}

#splash h1 {
    color:#fff;
    font-size:28px;
    letter-spacing:5px;
}

/* MAIN APP */
#app {
    display:none;
    width:100%; height:100%;
    background:#000;
}

/* Floating + button */
.add{
    position:fixed;
    bottom:25px;
    left:50%;
    transform:translateX(-50%);
    width:60px;
    height:60px;
    border:none;
    background:#2481cc;
    border-radius:20px;
    font-size:32px;
    color:#fff;
    z-index:1500;
    box-shadow:0 10px 25px rgba(36,129,204,.4);
}

/* Other styles same as before */
</style>
</head>
<body>

<!-- SPLASH SCREEN -->
<div id="splash">
    <img src="logo.png" alt="Cruise Logo">
    <h1>CRUISE</h1>
</div>

<!-- MAIN APP -->
<div id="app">

<!-- HEADER -->
<nav class="navbar" style="display:flex;align-items:center;justify-content:space-between;padding:10px;background:#111;color:#fff;">
    <button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
    <div class="logo">CRUISE</div>
    <div></div>
</nav>

<!-- SIDE MENU -->
<div id="side" style="position:fixed;top:0;left:-260px;width:260px;height:100%;background:#222;padding:25px;transition:.3s;z-index:3000;">
    <div class="side-title" style="color:white;font-size:20px;font-weight:800;margin-bottom:20px;">CRUISE</div>
    <button class="side-btn" onclick="openPage('home')">üè† Home</button>
    <button class="side-btn" onclick="openPage('profile')">üë§ Profile</button>
    <button class="side-btn" onclick="openPage('wallet')">üí∞ Wallet</button>
    <button class="side-btn" onclick="openPage('tasks')">‚úÖ Tasks</button>
    <button class="side-btn" onclick="openPage('ads')">üì¢ Post Ads</button>
</div>
<div id="overlay" onclick="toggleMenu()" style="position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;z-index:2500;"></div>

<!-- FEED -->
<div class="main" style="margin-top:65px;padding:15px;">
    <div id="v-home" class="view active"></div>
    <div id="v-wallet" class="view"></div>
    <div id="v-profile" class="view"></div>
    <div id="v-tasks" class="view"></div>
    <div id="v-ads" class="view"></div>
</div>

<!-- FLOAT BUTTON -->
<button class="add" onclick="showEd(true)">+</button>

<!-- EDITOR -->
<div id="editor" style="position:fixed;inset:0;background:#000;z-index:2000;padding:25px;display:flex;flex-direction:column;transform:translateY(100%);transition:.3s;">
    <div style="display:flex;justify-content:space-between;">
        <button onclick="showEd(false)" style="background:none;border:none;color:#888;">Cancel</button>
        <button onclick="send()" style="background:#2481cc;color:#fff;border:none;padding:10px 25px;border-radius:12px;font-weight:700;">Publish</button>
    </div>
    <textarea id="inp" style="flex:1;background:none;border:none;color:#fff;font-size:22px;margin-top:25px;" placeholder="What's the vibe?"></textarea>
</div>

</div>

<script>
// TELEGRAM
const tg = window.Telegram?.WebApp;
if(tg){ tg.ready(); tg.expand(); }

// SUPABASE
const SB_URL="https://chsybopznpfdvhmdspox.supabase.co";
const SB_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNoc3lib3B6bnBmZHZobWRzcG94Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE3MTEwMzQsImV4cCI6MjA4NzI4NzAzNH0.OFPBD6anJmowHfRhgK-UMaRpEJgO3UsxWJaFhPart9w";
const sb = supabase.createClient(SB_URL, SB_KEY);

// SPLASH SCREEN FADEOUT
window.addEventListener("load", () => {
    setTimeout(() => {
        const splash = document.getElementById("splash");
        splash.style.opacity = 0;
        setTimeout(()=> splash.style.display="none", 500);
        document.getElementById("app").style.display = "block";
    }, 2000); // 2 seconds splash
});

// MENU FUNCTIONS
function toggleMenu(){
    const side=document.getElementById("side");
    const overlay=document.getElementById("overlay");
    side.style.left = (side.style.left==="0px") ? "-260px":"0px";
    overlay.style.display = (overlay.style.display==="block") ? "none":"block";
}

function openPage(page){
    toggleMenu();
    document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
    document.getElementById('v-'+page).classList.add('active');
}

// EDITOR
function showEd(s){ document.getElementById('editor').classList.toggle('active', s); }

// LOAD POSTS
async function load(){
    const {data,error} = await sb.from('posts').select('*').order('created_at',{ascending:false});
    if(error) return;
    const feed = document.getElementById('v-home');
    feed.innerHTML = data.map(p=>`<div class="post"><b>@${p.username}</b><p>${p.content}</p></div>`).join('');
}

async function send(){
    const t=document.getElementById('inp').value.trim();
    if(!t) return;
    await sb.from('posts').insert([{username:"Guest",content:t}]);
    document.getElementById('inp').value="";
    showEd(false);
    load();
}

load();
</script>

</body>
</html>
